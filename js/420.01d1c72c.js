"use strict";(self["webpackChunkproject_management2"]=self["webpackChunkproject_management2"]||[]).push([[420],{8420:function(t,e,n){n.r(e),n.d(e,{default:function(){return D}});var r=n(6252),i=n(3577),o=n(9963);const l={class:"container py-5"},s={style:{"font-weight":"bold","text-align":"center"}},a=(0,r._)("h5",{style:{"font-weight":"bold","text-align":"center"}},"發包廠商",-1),u={class:"table table-hover mt-5",style:{overflow:"hidden","border-radius":"5px","box-shadow":"0 4px 20px rgba(0, 0, 0, 0.15)"}},c={class:"input-field"},p=(0,r._)("label",{for:"type"},"工種",-1),d=(0,r._)("option",{value:"",selected:"",disabled:""}," --請選擇-- ",-1),g=["value"],h={class:"input-field"},f=(0,r._)("label",{for:"quote"},"報價",-1),_={class:"input-field"},b=(0,r._)("label",{for:"title"},"成本",-1),m={class:"form-group mt-5"},y={class:"table table-hover",style:{overflow:"hidden","border-radius":"5px","box-shadow":"0 4px 20px rgba(0, 0, 0, 0.15)"}},w=(0,r._)("thead",null,[(0,r._)("tr",{style:{color:"white","font-weight":"bold",background:"#060411"}},[(0,r._)("td",null,"序號"),(0,r._)("td",null,"工種"),(0,r._)("td",null,"總報價"),(0,r._)("td",null,"總成本"),(0,r._)("td",null,"淨利"),(0,r._)("td",null,"毛利率"),(0,r._)("td",null,"動作")])],-1),j=(0,r.Uk)("明細"),v=["onClick"],T=(0,r._)("h5",{style:{"font-weight":"bold","text-align":"center"},class:"mt-5"},"總計",-1),E={class:"table table-hover",style:{overflow:"hidden","border-radius":"5px","box-shadow":"0 4px 20px rgba(0, 0, 0, 0.15)"}},x=(0,r._)("thead",null,[(0,r._)("tr",{style:{color:"white","font-weight":"bold",background:"#060411"}},[(0,r._)("td",null,"總報價"),(0,r._)("td",null,"總成本"),(0,r._)("td",null,"淨利"),(0,r._)("td",null,"毛利率")])],-1);function P(t,e,n,P,k,q){const z=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("h1",s,(0,i.zw)(k.project.title),1),a,(0,r._)("button",{onClick:e[0]||(e[0]=e=>t.$router.back()),type:"button",class:"btn btn-link"},"返回上一頁"),(0,r._)("table",u,[(0,r._)("tbody",null,[(0,r._)("tr",null,[(0,r._)("td",null,[(0,r._)("div",c,[p,(0,r.wy)((0,r._)("select",{name:"type",id:"type","onUpdate:modelValue":e[1]||(e[1]=t=>k.input.type=t)},[d,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.engineeringTypes,(t=>((0,r.wg)(),(0,r.iD)("option",{key:t.id,value:t.type},(0,i.zw)(t.type),9,g)))),128))],512),[[o.bM,k.input.type]])])]),(0,r._)("td",null,[(0,r._)("div",h,[f,(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>k.input.quote=t),placeholder:"輸入",id:"quote",type:"text"},null,512),[[o.nr,k.input.quote]])])]),(0,r._)("td",null,[(0,r._)("div",_,[b,(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>k.input.cost=t),placeholder:"輸入",id:"cost",type:"text"},null,512),[[o.nr,k.input.cost]])])]),(0,r._)("td",null,[(0,r._)("a",{class:"btn btn-primary",href:"#!",onClick:e[4]||(e[4]=(...t)=>q.addEngineering&&q.addEngineering(...t))},"新增")])])])]),(0,r._)("div",m,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>k.searchInput=t),onKeyup:e[6]||(e[6]=(0,o.D2)(((...t)=>q.serchEngineer&&q.serchEngineer(...t)),["enter"])),type:"text",name:"search",placeholder:"工種查詢",class:"form-control"},null,544),[[o.nr,k.searchInput]])]),(0,r._)("table",y,[w,(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(q.engineeringsShowMode,((t,e)=>((0,r.wg)(),(0,r.iD)("tr",{key:t.id},[(0,r._)("td",null,(0,i.zw)(e),1),(0,r._)("td",null,(0,i.zw)(t.type),1),(0,r._)("td",null,(0,i.zw)(t.quoteTotal),1),(0,r._)("td",null,(0,i.zw)(t.costTotal),1),(0,r._)("td",null,(0,i.zw)(t.profitTotal),1),(0,r._)("td",null,(0,i.zw)(t.profitMarginTotal),1),(0,r._)("td",null,[(0,r.Wm)(z,{to:{name:"engineering-todo",params:{id:t.id}},class:"btn btn-outline-primary"},{default:(0,r.w5)((()=>[j])),_:2},1032,["to"]),(0,r._)("a",{href:"#!",class:"btn btn-outline-danger",onClick:(0,o.iM)((e=>q.removeEngineering(t.id)),["stop","prevent"])},"移除",8,v)])])))),128))])]),T,(0,r._)("table",E,[x,(0,r._)("tbody",null,[(0,r._)("tr",null,[(0,r._)("td",null,(0,i.zw)(q.sumProjectQuote),1),(0,r._)("td",null,(0,i.zw)(q.sumProjectCost),1),(0,r._)("td",null,(0,i.zw)(q.sumGrossProfit),1),(0,r._)("td",null,(0,i.zw)(q.sumGrossProfitMargin),1)])])])])}n(7658);var k=n(5934),q=n(3907),z={name:"EngineeringsOverview",data(){return{project:[],input:{type:"",quote:0,cost:0},searchInput:"",filterEngineers:[]}},created(){const{id:t}=this.$route.params;this.project=this.projects[t],this.test(),this.calcProfitTotal(),this.calcProfitMarginTotal()},watch:{project:{handler(){this.project.projectQuote=0;let t=0;this.project.engineerings.forEach((e=>t+=e.quoteTotal)),this.project.projectQuote=t;let e=0;this.project.engineerings.forEach((t=>e+=t.costTotal)),this.project.projectCost=e,this.project.engineerings=this.calcProfitTotal(),this.project.engineerings=this.calcProfitMarginTotal()},deep:!0}},computed:{...(0,q.rn)(["projects","engineeringTypes"]),sumProjectQuote:{get(){let t=0;return this.project.engineerings.forEach((e=>t+=e.quoteTotal)),t}},sumProjectCost(){let t=0;return this.project.engineerings.forEach((e=>t+=e.costTotal)),t},sumGrossProfit(){return this.sumProjectQuote-this.sumProjectCost},sumGrossProfitMargin(){return(this.sumGrossProfit/this.sumProjectCost).toFixed(2)},engineeringsShowMode(){return 0===this.filterEngineers.length?this.project.engineerings:this.filterEngineers}},methods:{...(0,q.OI)(["removeProjectEngineering"]),test(){},calcProfitTotal(){return this.project.engineerings.forEach((t=>t.profitTotal=t.quoteTotal-t.costTotal)),this.project.engineerings},calcProfitMarginTotal(){return this.project.engineerings.forEach((t=>t.profitMarginTotal=(t.profitTotal/t.quoteTotal).toFixed(2))),this.project.engineerings},serchEngineer(t){t.preventDefault();const e=this.searchInput.trim();if(!e)return this.filterEngineers=this.project.engineerings,alert("您沒有輸入訊息");this.filterEngineers=this.project.engineerings.filter((t=>t.type.includes(e))),0===this.filterEngineers.length&&alert(`您輸入關鍵字：${e}沒有結果`),this.searchInput=""},addEngineering(t){t.preventDefault();const e=this.input.type;if(!e)return void alert("未選擇工種");let n=this.project.engineerings.some((t=>t.type===e));n?alert("此工種已在下列清單"):0!==this.input.quote?(this.project.engineerings.push({id:(0,k.Z)(),type:this.input.type,quoteTotal:Number(this.input.quote),costTotal:Number(this.input.cost)}),this.input.type="",this.input.quote=0,this.input.cost=0):alert("未輸入報價金額")},removeEngineering(t){this.project.engineerings=this.project.engineerings.filter((e=>e.id!==t))}}},C=n(3744);const M=(0,C.Z)(z,[["render",P]]);var D=M}}]);
//# sourceMappingURL=420.01d1c72c.js.map